<!doctype html><html lang=en class="js csstransforms3d">
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=generator content="Hugo 0.92.2">
<meta name=description content="Azure Cosmos DB Repository-Pattern .NET SDK">
<meta name=author content="David Pine">
<link rel="shortcut icon" href=/azure-cosmos-dotnet-repository/images/favicon.ico type=image/x-icon>
<link rel=icon href=/azure-cosmos-dotnet-repository/images/favicon.ico type=image/x-icon>
<title>Azure Cosmos DB Repository-Pattern .NET SDK</title>
<link href=/azure-cosmos-dotnet-repository/css/nucleus.css?1647288486 rel=stylesheet>
<link href=/azure-cosmos-dotnet-repository/css/fontawesome-all.min.css?1647288486 rel=stylesheet>
<link href=/azure-cosmos-dotnet-repository/css/hybrid.css?1647288486 rel=stylesheet>
<link href=/azure-cosmos-dotnet-repository/css/featherlight.min.css?1647288486 rel=stylesheet>
<link href=/azure-cosmos-dotnet-repository/css/perfect-scrollbar.min.css?1647288486 rel=stylesheet>
<link href=/azure-cosmos-dotnet-repository/css/auto-complete.css?1647288486 rel=stylesheet>
<link href=/azure-cosmos-dotnet-repository/css/atom-one-dark-reasonable.css?1647288486 rel=stylesheet>
<link href=/azure-cosmos-dotnet-repository/css/theme.css?1647288486 rel=stylesheet>
<link href=/azure-cosmos-dotnet-repository/css/tabs.css?1647288486 rel=stylesheet>
<link href=/azure-cosmos-dotnet-repository/css/hugo-theme.css?1647288486 rel=stylesheet>
<link href=/azure-cosmos-dotnet-repository/css/theme-custom.css?1647288486 rel=stylesheet>
<script src=/azure-cosmos-dotnet-repository/js/jquery-3.3.1.min.js?1647288486></script>
<style>:root #header+#content>#left>#rlblock_left{display:none!important}:not(pre)>code+span.copy-to-clipboard{display:none}</style>
</head>
<body data-url=/azure-cosmos-dotnet-repository/6-major-release-notes/>
<nav id=sidebar class=showVisitedLinks>
<div id=header-wrapper>
<div id=header>
<a href=/>
<img src=https://ievangelist.github.io/azure-cosmos-dotnet-repository/images/logo.png style=max-height:90%;max-width:90% alt=Logo>
</a>
<h4 style=margin-top:0>
<a href=https://github.com/IEvangelist/azure-cosmos-dotnet-repository target=_blank id=my-site><i class="fas fa-code"></i>&nbsp;Cosmos DB</a>
</h3>
</div>
<div class=searchbox>
<label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span>
</div>
<script type=text/javascript src=/azure-cosmos-dotnet-repository/js/lunr.min.js?1647288486></script>
<script type=text/javascript src=/azure-cosmos-dotnet-repository/js/auto-complete.js?1647288486></script>
<script type=text/javascript>var baseurl="https://ievangelist.github.io/azure-cosmos-dotnet-repository/"</script>
<script type=text/javascript src=/azure-cosmos-dotnet-repository/js/search.js?1647288486></script>
</div>
<div class=highlightable>
<ul class=topics>
<li data-nav-id=/azure-cosmos-dotnet-repository/1-getting-started/ title="Getting Started" class=dd-item>
<a href=/azure-cosmos-dotnet-repository/1-getting-started/>
<b>1. </b>Getting Started
<i class="fas fa-check read-icon"></i>
</a>
<ul>
<li data-nav-id=/azure-cosmos-dotnet-repository/1-getting-started/partioning/ title=Partitioning class=dd-item>
<a href=/azure-cosmos-dotnet-repository/1-getting-started/partioning/>
Partitioning
<i class="fas fa-check read-icon"></i>
</a>
</li>
</ul>
</li>
<li data-nav-id=/azure-cosmos-dotnet-repository/2-container-config/ title="Container Configuration" class=dd-item>
<a href=/azure-cosmos-dotnet-repository/2-container-config/>
<b>2. </b>Container Configuration
<i class="fas fa-check read-icon"></i>
</a>
</li>
<li data-nav-id=/azure-cosmos-dotnet-repository/3-queries/ title=Querying class=dd-item>
<a href=/azure-cosmos-dotnet-repository/3-queries/>
<b>3. </b>Querying
<i class="fas fa-check read-icon"></i>
</a>
<ul>
<li data-nav-id=/azure-cosmos-dotnet-repository/3-queries/specification-pattern/ title="Specification Pattern" class=dd-item>
<a href=/azure-cosmos-dotnet-repository/3-queries/specification-pattern/>
Specification Pattern
<i class="fas fa-check read-icon"></i>
</a>
</li>
</ul>
</li>
<li data-nav-id=/azure-cosmos-dotnet-repository/4-change-feed/ title="Change Feed" class=dd-item>
<a href=/azure-cosmos-dotnet-repository/4-change-feed/>
<b>4. </b>Change Feed
<i class="fas fa-check read-icon"></i>
</a>
</li>
<li data-nav-id=/azure-cosmos-dotnet-repository/5-miscellaneous/ title=Miscellaneous class=dd-item>
<a href=/azure-cosmos-dotnet-repository/5-miscellaneous/>
<b>5. </b>Miscellaneous
<i class="fas fa-check read-icon"></i>
</a>
<ul>
<li data-nav-id=/azure-cosmos-dotnet-repository/5-miscellaneous/logging/ title=Logging class=dd-item>
<a href=/azure-cosmos-dotnet-repository/5-miscellaneous/logging/>
Logging
<i class="fas fa-check read-icon"></i>
</a>
</li>
<li data-nav-id=/azure-cosmos-dotnet-repository/5-miscellaneous/unique-keys/ title="Unique Keys Policies" class=dd-item>
<a href=/azure-cosmos-dotnet-repository/5-miscellaneous/unique-keys/>
Unique Keys Policies
<i class="fas fa-check read-icon"></i>
</a>
</li>
</ul>
</li>
<li data-nav-id=/azure-cosmos-dotnet-repository/6-major-release-notes/ title="Major Release Notes" class="dd-item
parent
active">
<a href=/azure-cosmos-dotnet-repository/6-major-release-notes/>
<b>6. </b>Major Release Notes
<i class="fas fa-check read-icon"></i>
</a>
</li>
<li data-nav-id=/azure-cosmos-dotnet-repository/7-event-sourcing/ title="Event Sourcing" class=dd-item>
<a href=/azure-cosmos-dotnet-repository/7-event-sourcing/>
<b>7. </b>Event Sourcing
<i class="fas fa-check read-icon"></i>
</a>
</li>
</ul>
<section id=shortcuts>
<h3>More</h3>
<ul>
<li>
<a class=padding href=https://github.com/IEvangelist/azure-cosmos-dotnet-repository><i class="fab fa-github"></i> Github Repository</a>
</li>
<li>
<a class=padding href=https://twitter.com/davidpine7><i class="fab fa-twitter"></i> Follow @davidpine7</a>
</li>
<li>
<a class=padding href=https://github.com/IEvangelist/azure-cosmos-dotnet-repository#contributors-><i class="fas fa-bullhorn"></i> Collaborators</a>
</li>
</ul>
</section>
<section id=prefooter>
<hr>
<ul>
<li><a class=padding href=# data-clear-history-toggle><i class="fas fa-history fa-fw"></i> Clear History</a></li>
</ul>
</section>
<section id=footer>
<p>Built with <a href=https://github.com/matcornic/hugo-theme-learn><i class="fas fa-heart"></i></a> from <a href=https://getgrav.org>Grav</a> and <a href=https://gohugo.io/>Hugo</a></p>
</section>
</div>
</nav>
<section id=body>
<div id=overlay></div>
<div class="padding highlightable">
<div>
<div id=top-bar>
<div id=top-github-link>
<a class=github-link title="Edit this page" href=https://github.com/IEvangelist/azure-cosmos-dotnet-repository6-major-release-notes/_index.md target=blank>
<i class="fas fa-code-branch"></i>
<span id=top-github-link-text>Edit this page</span>
</a>
</div>
<div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb>
<span id=sidebar-toggle-span>
<a href=# id=sidebar-toggle data-sidebar-toggle>
<i class="fas fa-bars"></i>
</a>
</span>
<span class=links>
<a href=/azure-cosmos-dotnet-repository/></a> > Major Release Notes
</span>
</div>
</div>
</div>
<div id=head-tags>
</div>
<div id=chapter>
<div id=body-inner>
<h1 id=release-300>Release 3.0.0</h1>
<h2 id=nullable-reference-types>Nullable Reference Types</h2>
<p>The most significant change to the library is the support for nullable reference types. The API surface has been updated to fully support null reference types. This may introduce warnings to code that previously may not have had to be null aware. This will introduce compile errors in projects that have <code>&lt;TreatWarningsAsErrors>True&lt;/TreatWarningsAsErrors></code> in a projects <code>.csproj</code> file.</p>
<h2 id=getasync-method>GetAsync method.</h2>
<p>The <code>_repository.GetAsync(id, partitionKey)</code> method was used to previously have a scenario where the API would return <code>null</code>.</p>
<p>This case was when the library read an item from cosmos successfully but the <code>type</code> field did not match that of the name of the class used. i.e. take the example below.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json>{
    <span style=color:#f92672>&#34;partitionKey&#34;</span>: <span style=color:#e6db74>&#34;BookCategory&#34;</span>,
    <span style=color:#f92672>&#34;_etag&#34;</span>: <span style=color:#e6db74>&#34;\&#34;3100b48c-0000-0700-0000-6219f58b0000\&#34;&#34;</span>,
    <span style=color:#f92672>&#34;timeToLive&#34;</span>: <span style=color:#66d9ef>null</span>,
    <span style=color:#f92672>&#34;createdTimeUtc&#34;</span>: <span style=color:#e6db74>&#34;2022-02-26T09:40:27.000061Z&#34;</span>,
    <span style=color:#f92672>&#34;id&#34;</span>: <span style=color:#e6db74>&#34;Engineering&#34;</span>,
    <span style=color:#f92672>&#34;type&#34;</span>: <span style=color:#e6db74>&#34;BookCategory&#34;</span>, <span style=color:#75715e>// &lt;--------- TYPE Field
</span><span style=color:#75715e></span>    <span style=color:#f92672>&#34;_rid&#34;</span>: <span style=color:#e6db74>&#34;vG1RAMQtoX4LAAAAAAAAAA==&#34;</span>,
    <span style=color:#f92672>&#34;_self&#34;</span>: <span style=color:#e6db74>&#34;dbs/vG1RAA==/colls/vG1RAMQtoX4=/docs/vG1RAMQtoX4LAAAAAAAAAA==/&#34;</span>,
    <span style=color:#f92672>&#34;_attachments&#34;</span>: <span style=color:#e6db74>&#34;attachments/&#34;</span>,
    <span style=color:#f92672>&#34;_ts&#34;</span>: <span style=color:#ae81ff>1645868427</span>
}
</code></pre></div><p>Notice the type field&rsquo;s value is <code>BookCategory</code> if I was to use a repository let&rsquo;s say with a class called <code>Category</code> the repository that you&rsquo;d use via DI would look like <code>IRepository&lt;Category></code> when you made a read for this item the value of the <code>type</code> field from the above JSON does not match the name of the class. This would not previously result in an exception but return null to the caller.</p>
<p>📣 The library now in this case throws an exception instead of returning <code>null</code>. The exception that will be thrown in the <code>MissMatchedTypeDiscriminatorException</code> code the previously checked for <code>null</code> will now have to catch this exception.</p>
<h2 id=opt-in-to-receive-total-item-counts-when-paging>Opt-in to receive total item counts when paging.</h2>
<p>Previously when using either of the paging operations provided by this library it would run a count query for every page request. This, however, can incur a large RU charge for large data sets. For this reason, we have chosen to make this now an opt-in feature. When calling either of the paging methods you will need to pass a <code>bool</code> to indicate you would like the count query to be run. See an example below.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=color:#ae81ff>_d</span>ogRepository.PageAsync(
    d =&gt; d.Breed == <span style=color:#e6db74>&#34;cocker spaniel&#34;</span>, 
    pageNumber, 
    pageSize,
    returnTotal: <span style=color:#66d9ef>true</span>);
</code></pre></div><blockquote>
<p>this <code>returnTotal</code> field defaults to <code>false</code>.</p>
</blockquote>
<h2 id=etagitem-is-now-abstract>ETagItem is now abstract</h2>
<p>This is a small change that makes the <code>ETagItem</code> class abstract.</p>
<footer class=footline>
</footer>
</div>
</div>
</div>
<div id=navigation>
<a class="nav nav-prev" href=/azure-cosmos-dotnet-repository/5-miscellaneous/unique-keys/ title="Unique Keys Policies"> <i class="fa fa-chevron-left"></i></a>
<a class="nav nav-next" href=/azure-cosmos-dotnet-repository/7-event-sourcing/ title="Event Sourcing" style=margin-right:0><i class="fa fa-chevron-right"></i></a>
</div>
</section>
<div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px>
<div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div>
</div>
<script src=/azure-cosmos-dotnet-repository/js/clipboard.min.js?1647288486></script>
<script src=/azure-cosmos-dotnet-repository/js/perfect-scrollbar.min.js?1647288486></script>
<script src=/azure-cosmos-dotnet-repository/js/perfect-scrollbar.jquery.min.js?1647288486></script>
<script src=/azure-cosmos-dotnet-repository/js/jquery.sticky.js?1647288486></script>
<script src=/azure-cosmos-dotnet-repository/js/featherlight.min.js?1647288486></script>
<script src=/azure-cosmos-dotnet-repository/js/highlight.pack.js?1647288486></script>
<script>hljs.initHighlightingOnLoad()</script>
<script src=/azure-cosmos-dotnet-repository/js/modernizr.custom-3.6.0.js?1647288486></script>
<script src=/azure-cosmos-dotnet-repository/js/learn.js?1647288486></script>
<script src=/azure-cosmos-dotnet-repository/js/hugo-learn.js?1647288486></script>
</body>
</html>